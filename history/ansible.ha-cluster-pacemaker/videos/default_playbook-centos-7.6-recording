{"version": 2, "width": 159, "height": 42, "timestamp": 1549794669, "env": {"SHELL": "/bin/bash", "TERM": "rxvt-unicode"}}
[0.973624, "o", "!! python-jinja2 package in CentOS/RHEL is very old and has some incopatibilities.\r\nNewer version is required when running plaubook from CentOS/RHEL machine !!\r\nYou can use steps below as root to get newer version of python-jinja2 package.\r\n\r\n[root@examples ~]# curl https://copr.fedorainfracloud.org/coprs/ondrejhome/ansible-deps-el7/repo/epel-7/ondrejhome-ansible-deps-el7-epel-7.repo > /etc/yum.repos.d/ondrejhome-ansible-deps-el7-epel-7.repo\r\n[root@examples ~]# yum update python-jinja2 python-markupsafe\r\n\r\n"]
[10.976819, "o", "[user@examples ~]$ cat /etc/redhat-release\r\n"]
[10.979846, "o", "CentOS Linux release 7.6.1810 (Core) \r\n"]
[11.983761, "o", "[user@examples ~]$ ansible --version\r\n"]
[12.505277, "o", "ansible 2.4.2.0\r\n  config file = /etc/ansible/ansible.cfg\r\n  configured module search path = [u'/home/user/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']\r\n  ansible python module location = /usr/lib/python2.7/site-packages/ansible\r\n  executable location = /usr/bin/ansible\r\n  python version = 2.7.5 (default, Oct 30 2018, 23:45:53) [GCC 4.8.5 20150623 (Red Hat 4.8.5-36)]\r\n"]
[13.523101, "o", "[user@examples ~]$ cat our_environment\r\n"]
[13.524704, "o", "============================================================\r\nKVM running 2 VMs with following configuration.\r\nKey for fence_xvm is located at /etc/cluster/fence_xvm.key\r\non machine from which we run ansible.\r\nVM-1:\r\n  IP address:  192.168.34.41\r\n  VM name:     fastvm-centos-7.6-41 (as seen by hypervisor)\r\n  VM hostname: fastvm-centos-7-6-41\r\nVM-2:\r\n  IP address:  192.168.34.42\r\n  VM name:     fastvm-centos-7.6-42 (as seen by hypervisor)\r\n  VM hostname: fastvm-centos-7-6-42\r\n============================================================\r\n"]
[17.528478, "o", "[user@examples ~]$ ls -l /etc/cluster/fence_xvm.key\r\n"]
[17.536275, "o", "-rw-r--r--. 1 root root 4096 Feb 10 11:29 /etc/cluster/fence_xvm.key\r\n"]
[19.539866, "o", "[user@examples ~]$ ansible-galaxy install OndrejHome.ha-cluster-pacemaker,19.0.0 OndrejHome.pcs-modules-2,19.0.0 -p roles\r\n"]
[20.069672, "o", "- downloading role 'ha-cluster-pacemaker', owned by OndrejHome\r\n"]
[20.70266, "o", "- downloading role from https://github.com/OndrejHome/ansible.ha-cluster-pacemaker/archive/19.0.0.tar.gz\r\n"]
[21.516866, "o", "- extracting OndrejHome.ha-cluster-pacemaker to /home/user/roles/OndrejHome.ha-cluster-pacemaker\r\n"]
[21.541769, "o", "- OndrejHome.ha-cluster-pacemaker (19.0.0) was installed successfully\r\n"]
[21.542829, "o", "- dependency OndrejHome.pcs-modules-2 already pending installation.\r\n"]
[21.640853, "o", "- downloading role 'pcs-modules-2', owned by OndrejHome\r\n"]
[21.966692, "o", "- downloading role from https://github.com/OndrejHome/ansible.pcs-modules-2/archive/19.0.0.tar.gz\r\n"]
[22.780968, "o", "- extracting OndrejHome.pcs-modules-2 to /home/user/roles/OndrejHome.pcs-modules-2\r\n"]
[22.796889, "o", "- OndrejHome.pcs-modules-2 (19.0.0) was installed successfully\r\n"]
[24.862036, "o", "[user@examples ~]$ cat hosts-default\r\n"]
[24.864301, "o", "[servers]\r\n192.168.22.41 vm_name=fastvm-centos-7.6-41\r\n192.168.22.42 vm_name=fastvm-centos-7.6-42\r\n"]
[27.868254, "o", "[user@examples ~]$ cat playbook-default.yml\r\n"]
[27.870809, "o", "---\r\n- hosts: servers\r\n  remote_user: root\r\n  roles:\r\n  - { role: OndrejHome.ha-cluster-pacemaker }\r\n"]
[29.874274, "o", "[user@examples ~]$ ansible-playbook -i hosts-default playbook-default.yml\r\n"]
[30.632701, "o", "\r\nPLAY [servers] *****************************************************************\r\n"]
[30.64064, "o", "\r\nTASK [Gathering Facts] *********************************************************\r\n"]
[31.280295, "o", "\u001b[0;32mok: [192.168.22.42]\u001b[0m\r\n"]
[31.303001, "o", "\u001b[0;32mok: [192.168.22.41]\u001b[0m\r\n"]
[31.321764, "o", "\r\nTASK [OndrejHome.ha-cluster-pacemaker : Check if cluster consist of at least 2 nodes] ***\r\n"]
[31.352372, "o", "\u001b[0;36mskipping: [192.168.22.41]\u001b[0m\r\n"]
[31.370057, "o", "\r\nTASK [OndrejHome.ha-cluster-pacemaker : Include distribution version specific variables - RHEL/CentOS] ***\r\n"]
[31.43933, "o", "\u001b[0;32mok: [192.168.22.41]\u001b[0m\r\n"]
[31.450399, "o", "\u001b[0;32mok: [192.168.22.42]\u001b[0m\r\n"]
[31.454894, "o", "\r\nTASK [OndrejHome.ha-cluster-pacemaker : Include distribution version specific variables - Fedora] ***\r\n"]
[31.465348, "o", "\u001b[0;36mskipping: [192.168.22.41]\u001b[0m\r\n"]
[31.470657, "o", "\u001b[0;36mskipping: [192.168.22.42]\u001b[0m\r\n"]
[31.474167, "o", "\r\nTASK [OndrejHome.ha-cluster-pacemaker : (RHEL only) enable repositories] *******\r\n"]
[31.485354, "o", "\u001b[0;36mskipping: [192.168.22.41]\u001b[0m\r\n"]
[31.490651, "o", "\u001b[0;36mskipping: [192.168.22.42]\u001b[0m\r\n"]
[31.494115, "o", "\r\nTASK [OndrejHome.ha-cluster-pacemaker : Install packages from local media] *****\r\n"]
[31.50433, "o", "\u001b[0;36mskipping: [192.168.22.41]\u001b[0m\r\n"]
[31.513699, "o", "\u001b[0;36mskipping: [192.168.22.42]\u001b[0m\r\n"]
[31.514222, "o", "\r\nTASK [OndrejHome.ha-cluster-pacemaker : Install packages from system defined repositories] ***\r\n"]
[31.547657, "o", "\u001b[0;36mincluded: /home/user/roles/OndrejHome.ha-cluster-pacemaker/tasks/install_normal.yml for 192.168.22.41, 192.168.22.42\u001b[0m\r\n"]
[31.559779, "o", "\r\nTASK [OndrejHome.ha-cluster-pacemaker : Install libselinux-python to work with SELinux setting] ***\r\n"]
[32.766614, "o", "\u001b[0;32mok: [192.168.22.42]\u001b[0m\r\n"]
[32.774609, "o", "\u001b[0;32mok: [192.168.22.41]\u001b[0m\r\n"]
[32.7881, "o", "\r\nTASK [OndrejHome.ha-cluster-pacemaker : Install Pacemaker cluster packages to all nodes] ***\r\n"]
[33.42589, "o", "\u001b[0;33mchanged: [192.168.22.42]\u001b[0m\r\n"]
[33.510193, "o", "\u001b[0;33mchanged: [192.168.22.41]\u001b[0m\r\n"]
[33.515479, "o", "\r\nTASK [OndrejHome.ha-cluster-pacemaker : Install python3 package for manipulating firewalld] ***\r\n"]
[33.542822, "o", "\u001b[0;36mskipping: [192.168.22.41]\u001b[0m\r\n"]
[33.57674, "o", "\u001b[0;36mskipping: [192.168.22.42]\u001b[0m\r\n"]
[33.591818, "o", "\r\nTASK [OndrejHome.ha-cluster-pacemaker : Install package(s) for fence_xvm] ******\r\n"]
[33.785177, "o", "\u001b[0;33mchanged: [192.168.22.42]\u001b[0m\r\n"]
[33.7982, "o", "\u001b[0;33mchanged: [192.168.22.41]\u001b[0m\r\n"]
[33.802836, "o", "\r\nTASK [OndrejHome.ha-cluster-pacemaker : Install package(s) for fence_kdump] ****\r\n"]
[33.818479, "o", "\u001b[0;36mskipping: [192.168.22.41]\u001b[0m\r\n"]
[33.843595, "o", "\u001b[0;36mskipping: [192.168.22.42]\u001b[0m\r\n"]
[33.869408, "o", "\r\nTASK [OndrejHome.ha-cluster-pacemaker : Add hosts to /etc/hosts] ***************\r\n"]
[34.473123, "o", "\u001b[0;33mchanged: [192.168.22.41] => (item=192.168.22.41)\u001b[0m\r\n"]
[34.505253, "o", "\u001b[0;33mchanged: [192.168.22.42] => (item=192.168.22.41)\u001b[0m\r\n"]
[35.001569, "o", "\u001b[0;33mchanged: [192.168.22.41] => (item=192.168.22.42)\u001b[0m\r\n"]
[35.005762, "o", "\u001b[0;33mchanged: [192.168.22.42] => (item=192.168.22.42)\u001b[0m\r\n"]
[35.009472, "o", "\r\nTASK [OndrejHome.ha-cluster-pacemaker : Create cluster system group] ***********\r\n"]
[35.640322, "o", "\u001b[0;32mok: [192.168.22.42]\u001b[0m\r\n"]
[35.645518, "o", "\u001b[0;32mok: [192.168.22.41]\u001b[0m\r\n"]
[35.64982, "o", "\r\nTASK [OndrejHome.ha-cluster-pacemaker : Create cluster system user] ************\r\n"]
[35.683929, "o", "\u001b[0;33mchanged: [192.168.22.42]\u001b[0m\r\n"]
[35.699936, "o", "\u001b[0;33mchanged: [192.168.22.41]\u001b[0m\r\n"]
[35.713962, "o", "\r\nTASK [OndrejHome.ha-cluster-pacemaker : Enable/Disable PCSD web GUI] ***********\r\n"]
[35.752657, "o", "\u001b[0;36mskipping: [192.168.22.41]\u001b[0m\r\n"]
[35.772362, "o", "\u001b[0;36mskipping: [192.168.22.42]\u001b[0m\r\n"]
[35.784344, "o", "\r\nTASK [OndrejHome.ha-cluster-pacemaker : Enable and start PCSD service] *********\r\n"]
[35.974605, "o", "\u001b[0;33mchanged: [192.168.22.41]\u001b[0m\r\n"]
[36.08402, "o", "\u001b[0;33mchanged: [192.168.22.42]\u001b[0m\r\n"]
[36.088811, "o", "\r\nTASK [OndrejHome.ha-cluster-pacemaker : Setup firewall for RHEL/CentOS systems] ***\r\n"]
[36.121219, "o", "\u001b[0;36mincluded: /home/user/roles/OndrejHome.ha-cluster-pacemaker/tasks/firewall-el7.yml for 192.168.22.41, 192.168.22.42\u001b[0m\r\n"]
[36.13422, "o", "\r\nTASK [OndrejHome.ha-cluster-pacemaker : Enable 'high-availability' firewalld service] ***\r\n"]
[37.070919, "o", "\u001b[0;33mchanged: [192.168.22.42]\u001b[0m\r\n"]
[37.079458, "o", "\u001b[0;33mchanged: [192.168.22.41]\u001b[0m\r\n"]
[37.092901, "o", "\r\nTASK [OndrejHome.ha-cluster-pacemaker : Setup firewall for Fedora systems] *****\r\n"]
[37.139673, "o", "\u001b[0;36mskipping: [192.168.22.41]\u001b[0m\r\n"]
[37.160922, "o", "\u001b[0;36mskipping: [192.168.22.42]\u001b[0m\r\n"]
[37.172027, "o", "\r\nTASK [OndrejHome.ha-cluster-pacemaker : Authorize cluster nodes] ***************\r\n"]
[37.44716, "o", "\u001b[0;33mchanged: [192.168.22.41] => (item=192.168.22.41)\u001b[0m\r\n"]
[38.371675, "o", "\u001b[0;33mchanged: [192.168.22.42] => (item=192.168.22.41)\u001b[0m\r\n"]
[39.23326, "o", "\u001b[0;33mchanged: [192.168.22.41] => (item=192.168.22.42)\u001b[0m\r\n"]
[39.686752, "o", "\u001b[0;33mchanged: [192.168.22.42] => (item=192.168.22.42)\u001b[0m\r\n"]
[39.701464, "o", "\r\nTASK [OndrejHome.ha-cluster-pacemaker : Setup cluster] *************************\r\n"]
[40.594196, "o", "\u001b[0;33mchanged: [192.168.22.41]\u001b[0m\r\n"]
[40.599468, "o", "\r\nTASK [OndrejHome.ha-cluster-pacemaker : Start cluster services on all nodes] ***\r\n"]
[40.74894, "o", "\u001b[0;33mchanged: [192.168.22.41] => (item=pacemaker)\u001b[0m\r\n"]
[40.86142, "o", "\u001b[0;33mchanged: [192.168.22.42] => (item=pacemaker)\u001b[0m\r\n"]
[41.143607, "o", "\u001b[0;32mok: [192.168.22.42] => (item=corosync)\u001b[0m\r\n"]
[41.157418, "o", "\u001b[0;32mok: [192.168.22.41] => (item=corosync)\u001b[0m\r\n"]
[41.163487, "o", "\r\nTASK [OndrejHome.ha-cluster-pacemaker : Enable cluster services on boot] *******\r\n"]
[41.756013, "o", "\u001b[0;33mchanged: [192.168.22.42] => (item=pacemaker)\u001b[0m\r\n"]
[41.829834, "o", "\u001b[0;33mchanged: [192.168.22.41] => (item=pacemaker)\u001b[0m\r\n"]
[42.18265, "o", "\u001b[0;33mchanged: [192.168.22.42] => (item=corosync)\u001b[0m\r\n"]
[42.189736, "o", "\u001b[0;33mchanged: [192.168.22.41] => (item=corosync)\u001b[0m\r\n"]
[42.19758, "o", "\r\nTASK [OndrejHome.ha-cluster-pacemaker : Setup automatic fence_xvm] *************\r\n"]
[42.238574, "o", "\u001b[0;36mincluded: /home/user/roles/OndrejHome.ha-cluster-pacemaker/tasks/fence_xvm.yml for 192.168.22.41, 192.168.22.42\u001b[0m\r\n"]
[42.262581, "o", "\r\nTASK [OndrejHome.ha-cluster-pacemaker : Check if 'vm_name' variable is defined for each node] ***\r\n"]
[42.276207, "o", "\u001b[0;36mskipping: [192.168.22.41]\u001b[0m\r\n"]
[42.288609, "o", "\u001b[0;36mskipping: [192.168.22.42]\u001b[0m\r\n"]
[42.293528, "o", "\r\nTASK [OndrejHome.ha-cluster-pacemaker : Create /etc/cluster directory] *********\r\n"]
[42.826874, "o", "\u001b[0;33mchanged: [192.168.22.42]\u001b[0m\r\n"]
[42.831561, "o", "\u001b[0;33mchanged: [192.168.22.41]\u001b[0m\r\n"]
[42.835568, "o", "\r\nTASK [OndrejHome.ha-cluster-pacemaker : Copy fence_xvm key to all cluster nodes] ***\r\n"]
[43.761762, "o", "\u001b[0;33mchanged: [192.168.22.42]\u001b[0m\r\n"]
[43.771589, "o", "\u001b[0;33mchanged: [192.168.22.41]\u001b[0m\r\n\r\nTASK [OndrejHome.ha-cluster-pacemaker : Enable fence_xvm port(1229/tcp) in firewalld] ***\r\n"]
[44.447294, "o", "\u001b[0;33mchanged: [192.168.22.41]\u001b[0m\r\n"]
[44.451609, "o", "\u001b[0;33mchanged: [192.168.22.42]\u001b[0m\r\n"]
[44.460623, "o", "\r\nTASK [OndrejHome.ha-cluster-pacemaker : create fence_xvm STONITH devices] ******\r\n"]
[45.417523, "o", "\u001b[0;33mchanged: [192.168.22.41] => (item=192.168.22.41)\u001b[0m\r\n"]
[45.472594, "o", "\u001b[0;33mchanged: [192.168.22.41] => (item=192.168.22.42)\u001b[0m\r\n"]
[45.478626, "o", "\r\nTASK [OndrejHome.ha-cluster-pacemaker : create fence constraints] **************\r\n"]
[46.384446, "o", "\u001b[0;33mchanged: [192.168.22.41] => (item=192.168.22.41)\u001b[0m\r\n"]
[47.302091, "o", "\u001b[0;33mchanged: [192.168.22.41] => (item=192.168.22.42)\u001b[0m\r\n"]
[47.306628, "o", "\r\nTASK [OndrejHome.ha-cluster-pacemaker : Setup fence_kdump] *********************\r\n"]
[47.317155, "o", "\u001b[0;36mskipping: [192.168.22.41]\u001b[0m\r\n"]
[47.33279, "o", "\u001b[0;36mskipping: [192.168.22.42]\u001b[0m\r\n"]
[47.338678, "o", "\r\nTASK [OndrejHome.ha-cluster-pacemaker : Setup custom fence devices] ************\r\n"]
[47.397991, "o", "\u001b[0;36mincluded: /home/user/roles/OndrejHome.ha-cluster-pacemaker/tasks/fence_custom.yml for 192.168.22.41, 192.168.22.42\u001b[0m\r\n"]
[47.473671, "o", "\r\nTASK [OndrejHome.ha-cluster-pacemaker : Create custom fence device] ************\r\n"]
[47.483648, "o", "\r\nPLAY RECAP *********************************************************************\r\n\u001b[0;33m192.168.22.41\u001b[0m              : \u001b[0;32mok=23  \u001b[0m \u001b[0;33mchanged=15  \u001b[0m unreachable=0    failed=0   \r\n\u001b[0;33m192.168.22.42\u001b[0m              : \u001b[0;32mok=20  \u001b[0m \u001b[0;33mchanged=12  \u001b[0m unreachable=0    failed=0   \r\n\r\n"]
